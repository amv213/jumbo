
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>jumbo package &#8212; Jumbo Documentation</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/twemoji.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js"></script>
    <script src="_static/twemoji.js"></script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="_static/favico.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ðŸŽˆ Basic Usage" href="tutorial_basic.html" />
    <link rel="prev" title="jumbo" href="modules.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo_single.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Jumbo Documentation</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   ðŸ“‘ Welcome to Jumbo!
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  MAIN DOCS
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro_package.html">
   First Steps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro_database.html">
   Database Setup
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="documentation.html">
   Documentation
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active collapsible-parent">
    <a class="reference internal" href="modules.html">
     Modules
    </a>
    <ul class="current collapse-ul">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       jumbo package
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  TUTORIALS
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="tutorial_basic.html">
   Basic Usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tutorial_watchdogs.html">
   Watchdogs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tutorial_listeners.html">
   Listeners
  </a>
 </li>
</ul>

</nav>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/jumbo.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://gitlab.com/amv213/jumbo"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://gitlab.com/amv213/jumbo/issues/new?title=Issue%20on%20page%20%2Fjumbo.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/amv213/jumbo/edit/master/docs/source/jumbo.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submodules">
   Submodules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-jumbo.config">
   jumbo.config module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-jumbo.database">
   jumbo.database module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-jumbo.handlers">
   jumbo.handlers module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-jumbo.utils">
   jumbo.utils module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-jumbo">
   Module contents
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="jumbo-package">
<h1>jumbo package<a class="headerlink" href="#jumbo-package" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">Â¶</a></h2>
</div>
<div class="section" id="module-jumbo.config">
<span id="jumbo-config-module"></span><h2>jumbo.config module<a class="headerlink" href="#module-jumbo.config" title="Permalink to this headline">Â¶</a></h2>
<dl class="py class">
<dt id="jumbo.config.Config">
<em class="property">class </em><code class="sig-prename descclassname">jumbo.config.</code><code class="sig-name descname">Config</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jumbo/config.html#Config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.config.Config" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration class setting global environment variables to connect to
a PostgreSQL database via Jumbo.</p>
<p>Variables are extracted from an existing jumbo.env file defining the
following variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DATABASE_HOST</span> <span class="o">=</span> <span class="n">the</span> <span class="n">PostgreSQL</span> <span class="n">server</span> <span class="n">host</span> <span class="n">address</span>
<span class="n">DATABASE_USERNAME</span> <span class="o">=</span> <span class="n">the</span> <span class="n">PostgreSQL</span> <span class="n">username</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user</span> <span class="n">connecting</span> <span class="n">to</span>
                    <span class="n">the</span> <span class="n">database</span>
<span class="n">DATABASE_PASSWORD</span> <span class="o">=</span> <span class="n">the</span> <span class="n">PostgreSQL</span> <span class="n">password</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user</span> <span class="n">connecting</span> <span class="n">to</span>
                    <span class="n">the</span> <span class="n">database</span>
<span class="n">DATABASE_PORT</span> <span class="o">=</span> <span class="n">the</span> <span class="n">port</span> <span class="n">on</span> <span class="n">which</span> <span class="n">the</span> <span class="n">PostgreSQL</span> <span class="n">server</span> <span class="ow">is</span> <span class="n">running</span>
                <span class="p">(</span><span class="n">usually</span> <span class="mi">5432</span><span class="p">)</span>
<span class="n">DATABASE_NAME</span> <span class="o">=</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">database</span> <span class="n">to</span> <span class="n">which</span> <span class="n">to</span> <span class="n">connect</span>
</pre></div>
</div>
<p>By default, the jumbo.env file should be located in the root working
directory of the script invoking the constructor.</p>
</dd></dl>

</div>
<div class="section" id="module-jumbo.database">
<span id="jumbo-database-module"></span><h2>jumbo.database module<a class="headerlink" href="#module-jumbo.database" title="Permalink to this headline">Â¶</a></h2>
<dl class="py class">
<dt id="jumbo.database.Database">
<em class="property">class </em><code class="sig-prename descclassname">jumbo.database.</code><code class="sig-name descname">Database</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jumbo/database.html#Database"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Jumboâ€™s abstract PostgreSQL client manager.</p>
<p>Allows to manage multiple independent connections to a PostgreSQL database
and to handle arbitrary transactions between clients and database.</p>
<p>Usage:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize abstract database manager</span>
<span class="n">database</span> <span class="o">=</span> <span class="n">jumbo</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">Database</span><span class="p">()</span>

<span class="c1"># Open a connection pool to the PostgreSQL database:</span>
<span class="k">with</span> <span class="n">database</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>

    <span class="c1"># Use a connection from the pool</span>
    <span class="k">with</span> <span class="n">pool</span><span class="o">.</span><span class="n">connect</span><span class="p">():</span>

        <span class="c1"># Execute SQL query on the database</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">SQL_query</span><span class="p">)</span>

<span class="c1"># context managers ensure connections are properly returned to the</span>
<span class="n">pool</span><span class="p">,</span> <span class="ow">and</span> <span class="n">that</span> <span class="n">the</span> <span class="n">pool</span> <span class="ow">is</span> <span class="n">properly</span> <span class="n">closed</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py method">
<dt id="jumbo.database.Database.close_pool">
<code class="sig-name descname">close_pool</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.close_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.close_pool" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Closes all connections in the pool, making it unusable by clients.</p>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.connect">
<code class="sig-name descname">connect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.connect" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Context manager opening a connection to the PostgreSQL database
using a connection [key] from the pool. The connection is
automatically closed on exit and all transactions are properly handled.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># check-out connection from the pool</span>
<span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>

    <span class="c1"># do something with the connection e.g.</span>
    <span class="c1"># self.send(sql_query, key)</span>

<span class="c1"># connection is automatically closed here</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>optional</em>) â€“ key to identify the connection being opened.
Required for proper book keeping.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.connection_info">
<code class="sig-name descname">connection_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; psycopg2.extras.DictRow<a class="reference internal" href="_modules/jumbo/database.html#Database.connection_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.connection_info" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fetches PostgreSQL database version.</p>
<div class="highlight-postgresql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Command executed:</span>
<span class="k">SELECT</span> <span class="k">version</span><span class="p">();</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>optional</em>) â€“ key of the pool connection being used in the
transaction. Defaults to [1].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>query result. Contains PostgreSQL database version information.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.copy_df">
<code class="sig-name descname">copy_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span><span class="p">:</span> <span class="n">pandas.core.frame.DataFrame</span></em>, <em class="sig-param"><span class="n">db_table</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">replace</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.copy_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.copy_df" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Utility wrapper to efficiently copy a pandas.DataFrame to a
PostgreSQL database table.</p>
<p>This method is faster than pandaâ€™s native <em>.to_sql()</em> method and
exploits PostgreSQL COPY TO command. Provides a useful mean of saving
results from a pandas-centred data analysis pipeline directly to the
database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> â€“ dataframe to be copied.</p></li>
<li><p><strong>db_table</strong> â€“ the name (optionally schema-qualified) of the
table to write to.</p></li>
<li><p><strong>replace</strong> (<em>optional</em>) â€“ replaces table contents if True. Appends data
to table contents otherwise.</p></li>
<li><p><strong>key</strong> (<em>optional</em>) â€“ key of the pool connection being used in the
transaction. Defaults to [1].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.copy_to_table">
<code class="sig-name descname">copy_to_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query</span><span class="p">:</span> <span class="n">psycopg2.sql.Composed</span></em>, <em class="sig-param"><span class="n">file</span><span class="p">:</span> <span class="n">IO</span></em>, <em class="sig-param"><span class="n">db_table</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">replace</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.copy_to_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.copy_to_table" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Utility wrapper to send a SQL query to copy data to database table.
Allows to replace table if it already exists in the database.</p>
<div class="highlight-postgresql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Command type expected:</span>
<span class="k">COPY</span> <span class="n">table_name</span> <span class="p">[</span> <span class="p">(</span> <span class="n">column_name</span> <span class="p">[,</span> <span class="mf">...</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
    <span class="k">FROM</span> <span class="k">STDIN</span>
    <span class="p">[</span> <span class="p">[</span> <span class="k">WITH</span> <span class="p">]</span> <span class="p">(</span> <span class="k">option</span> <span class="p">[,</span> <span class="mf">...</span><span class="p">]</span> <span class="p">)</span> <span class="p">]</span>

<span class="c1">-- Ancillary command pre-executed:</span>
<span class="k">TRUNCATE</span> <span class="n">table_name</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy csv data from file to a table in the database</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;COPY table_name FROM STDIN WITH CSV DELIMITER &#39;</span><span class="se">\t</span><span class="s2">&#39;&quot;</span>
<span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_to_table</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;C:\data.csv&quot;</span><span class="p">,</span>
                             <span class="n">db_table</span><span class="o">=</span><span class="s1">&#39;table_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> â€“ PostgreSQL COPY command string.</p></li>
<li><p><strong>file</strong> â€“ absolute path to file-like object to read data
from.</p></li>
<li><p><strong>db_table</strong> â€“ the name (optionally schema-qualified) of an
existing database table.</p></li>
<li><p><strong>replace</strong> (<em>optional</em>) â€“ replaces table contents if True. Appends data
to table contents otherwise.</p></li>
<li><p><strong>key</strong> (<em>optional</em>) â€“ key of the pool connection being used in the
transaction. Defaults to [1].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.get_connection">
<code class="sig-name descname">get_connection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.get_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.get_connection" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Connect to a Postgres database using an available connection from
pool. The connection is assigned to â€˜keyâ€™ on checkout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>optional</em>) â€“ key to assign to the connection being opened.
Required for proper book keeping.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.listen_on_channel">
<code class="sig-name descname">listen_on_channel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">channel_name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.listen_on_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.listen_on_channel" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Subscribes to a PostgreSQL notification channel by listening for
NOTIFYs.</p>
<div class="highlight-postgresql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Command executed:</span>
<span class="k">LISTEN</span> <span class="n">channel_name</span><span class="p">;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel_name</strong> â€“ channel on which to LISTEN. PostgreSQL database
should be configured to send NOTIFYs on this
channel.</p></li>
<li><p><strong>key</strong> (<em>optional</em>) â€“ key of the pool connection being used in the
transaction. Defaults to [1].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.on_connection">
<code class="sig-name descname">on_connection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.on_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.on_connection" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Client-database handshaking script to perform on retrieval of a
PostgreSQL connection from the pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>optional</em>) â€“ key of the pool connection being used in
the transaction. Defaults to [1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.open">
<code class="sig-name descname">open</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minconns</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">maxconns</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.open" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Context manager opening a connection pool to the PostgreSQL
database. The pool is automatically closed on exit and all
connections are properly handled.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>

    <span class="c1"># do something with the pool</span>

<span class="c1"># pool is automatically closed here</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minconns</strong> â€“ minimum amount of available connections in the pool,
created on startup.</p></li>
<li><p><strong>maxconns</strong> â€“ maximum amount of available connections supported by
the pool. Defaults to minconns.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.open_pool">
<code class="sig-name descname">open_pool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minconns</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">maxconns</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.open_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.open_pool" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Initialises and opens a connection pool to the PostgreSQL database
(psycopg2.pool.ThreadedConnectionPool).</p>
<p>â€˜minconnâ€™ new connections are created  immediately. The connection pool
will support a maximum of about â€˜maxconnâ€™ connections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minconns</strong> â€“ minimum amount of available connections in the pool,
created on startup.</p></li>
<li><p><strong>maxconns</strong> â€“ maximum amount of available connections supported by
the pool. Defaults to â€˜minconnsâ€™.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.put_back_connection">
<code class="sig-name descname">put_back_connection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/database.html#Database.put_back_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.put_back_connection" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Puts back a connection in the connection pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>optional</em>) â€“ key of the pool connection being used in the
transaction. Defaults to [1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.database.Database.send">
<code class="sig-name descname">send</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>psycopg2.sql.Composed<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">subs</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Tuple<span class="p">[</span>str<span class="p">, </span><span class="p">â€¦</span><span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cur_method</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">file</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>IO<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fetch_method</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">2</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>psycopg2.extras.DictRow<span class="p">]</span><a class="reference internal" href="_modules/jumbo/database.html#Database.send"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.database.Database.send" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Sends an arbitrary PostgreSQL query to the PostgreSQL database.
Transactions are auto-committed on execution.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># A simple query with no substitutions</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;SELECT * FROM table_name;&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="c1"># A more complex query with dynamic substitutions</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO table_name (column_name, another_column_name) VALUES (</span><span class="si">%s</span><span class="s1">, $s);&#39;</span>
<span class="n">subs</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">another_value</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">subs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> â€“ PostgreSQL command string (can be
template with psycopg2 %s fields).</p></li>
<li><p><strong>subs</strong> (<em>optional</em>) â€“ tuple of values to substitute in SQL
query  template (cf. psycopg2 %s
formatting)</p></li>
<li><p><strong>cur_method</strong> (<em>optional</em>) â€“ code to select which psycopg2 cursor
execution method to use for the SQL
query:
0:  cursor.execute()
1:  cursor.copy_expert()</p></li>
<li><p><strong>file</strong> (<em>optional</em>) â€“ file-like object to read or write to
(only relevant if cur_method:1).</p></li>
<li><p><strong>fetch_method</strong> (<em>optional</em>) â€“ code to select which psycopg2 result
retrieval method to use (fetch*()):
0: cur.fetchone()
2: cur.fetchall()</p></li>
<li><p><strong>key</strong> (<em>optional</em>) â€“ key of the pool connection being used
in the transaction. Defaults to [1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of query results (if any). Can be accessed as dictionaries.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-jumbo.handlers">
<span id="jumbo-handlers-module"></span><h2>jumbo.handlers module<a class="headerlink" href="#module-jumbo.handlers" title="Permalink to this headline">Â¶</a></h2>
<dl class="py class">
<dt id="jumbo.handlers.FileWatcher">
<em class="property">class </em><code class="sig-prename descclassname">jumbo.handlers.</code><code class="sig-name descname">FileWatcher</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">database</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#jumbo.database.Database" title="jumbo.database.Database">jumbo.database.Database</a></span></em>, <em class="sig-param"><span class="n">query</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>psycopg2.sql.Composed<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">src_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">recursive</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">patterns</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_directories</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jumbo/handlers.html#FileWatcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.FileWatcher" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Watchdog periodically polling a directory for file changes and
streaming updates to PostgreSQL database.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Template SQL command to execute on trigger</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;INSERT INTO table_name &#39;</span>                     <span class="s1">&#39;(column_name, another_column_name) VALUES (</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span>

<span class="c1"># Create watchdog</span>
<span class="n">fido</span> <span class="o">=</span> <span class="n">FileWatcher</span><span class="p">(</span><span class="n">jumbo</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">Database</span><span class="p">(),</span>
                   <span class="n">SQL_INSERT_IN_TABLE</span><span class="p">,</span> <span class="s1">&#39;data/&#39;</span><span class="p">,</span>
                   <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*.txt&quot;</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Deploy watchdog</span>
<span class="n">fido</span><span class="o">.</span><span class="n">bark</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="jumbo.handlers.FileWatcher.bark">
<code class="sig-name descname">bark</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; NoReturn<a class="reference internal" href="_modules/jumbo/handlers.html#FileWatcher.bark"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.FileWatcher.bark" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Schedules and starts the watchdog.</p>
<p>The scriptâ€™s main thread is kept alive in an infinite while loop,
while the watchdog starts periodically polling the filesystem for
changes on a separate thread. A third concurrent thread is released
from lock and executes every time a change has been detected.</p>
</dd></dl>

<dl class="py method">
<dt id="jumbo.handlers.FileWatcher.start">
<code class="sig-name descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#FileWatcher.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.FileWatcher.start" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Schedule and starts concurrent watchdog observer threads.</p>
</dd></dl>

<dl class="py method">
<dt id="jumbo.handlers.FileWatcher.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#FileWatcher.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.FileWatcher.stop" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Stops watchdog threads.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="jumbo.handlers.InsertToSQL">
<em class="property">class </em><code class="sig-prename descclassname">jumbo.handlers.</code><code class="sig-name descname">InsertToSQL</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">database</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#jumbo.database.Database" title="jumbo.database.Database">jumbo.database.Database</a></span></em>, <em class="sig-param"><span class="n">query</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>psycopg2.sql.Composed<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">patterns</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_patterns</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_directories</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">case_sensitive</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jumbo/handlers.html#InsertToSQL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.InsertToSQL" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">watchdog.events.PatternMatchingEventHandler</span></code></p>
<p>Event handler firing whenever a filesystem modification is detected.
Executes arbitrary SQL query on trigger.</p>
<dl class="py method">
<dt id="jumbo.handlers.InsertToSQL.on_modified">
<code class="sig-name descname">on_modified</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">event</span><span class="p">:</span> <span class="n">watchdog.events.FileSystemEvent</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#InsertToSQL.on_modified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.InsertToSQL.on_modified" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Overwrites default on_modified event trigger fired when filesystem
modification detected.</p>
<p>Here we want to ignore taking action if a filesystem directory has
been modified (only want to act on files).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>event</strong> â€“ watchdog event</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="jumbo.handlers.InsertToSQL.process_event">
<code class="sig-name descname">process_event</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">event</span><span class="p">:</span> <span class="n">watchdog.events.FileSystemEvent</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#InsertToSQL.process_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.InsertToSQL.process_event" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Function handling what happens to an event raised by the watchdog:
here we write any file changes as new entries in a database table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>event</strong> â€“ watchdog event</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="jumbo.handlers.LastEntryFetcher">
<em class="property">class </em><code class="sig-prename descclassname">jumbo.handlers.</code><code class="sig-name descname">LastEntryFetcher</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">database</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#jumbo.database.Database" title="jumbo.database.Database">jumbo.database.Database</a></span></em>, <em class="sig-param"><span class="n">audit_table</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jumbo/handlers.html#LastEntryFetcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.LastEntryFetcher" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#jumbo.handlers.NotifyHandler" title="jumbo.handlers.NotifyHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">jumbo.handlers.NotifyHandler</span></code></a></p>
<p>Custom handler which fetches las entry in a PostgreSQL audit table on
trigger.</p>
<dl class="py method">
<dt id="jumbo.handlers.LastEntryFetcher.on_notify">
<code class="sig-name descname">on_notify</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#LastEntryFetcher.on_notify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.LastEntryFetcher.on_notify" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fetch entry that triggered the notify</p>
</dd></dl>

<dl class="py method">
<dt id="jumbo.handlers.LastEntryFetcher.process">
<code class="sig-name descname">process</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iter_results</span><span class="p">:</span> <span class="n">psycopg2.extras.DictRow</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#LastEntryFetcher.process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.LastEntryFetcher.process" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Logs results to console.</p>
<p>Overwrite if need more complex data analysis on last entry in audit
table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iter_results</strong> â€“ last entry in table. Can be accessed as dictionary.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="jumbo.handlers.Listener">
<em class="property">class </em><code class="sig-prename descclassname">jumbo.handlers.</code><code class="sig-name descname">Listener</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">database</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#jumbo.database.Database" title="jumbo.database.Database">jumbo.database.Database</a></span></em>, <em class="sig-param"><span class="n">channel</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">handler</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#jumbo.handlers.NotifyHandler" title="jumbo.handlers.NotifyHandler">jumbo.handlers.NotifyHandler</a></span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/jumbo/handlers.html#Listener"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.Listener" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A concurrent thread manager listening for PostgreSQL database NOTIFYs
on a given channel. On receipt of a notify a custom event handler takes
action.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose handler: must have a .on_notify(self) method implemented.</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">jumbo</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">LastEntryFetcher</span><span class="p">(</span><span class="n">jumbo_Database</span><span class="p">,</span>
                                          <span class="n">audit_table</span><span class="p">)</span>
<span class="c1"># Create listener triggering handler&#39;s .on_notify(self) on NOTIFY</span>
<span class="n">dumbo</span> <span class="o">=</span> <span class="n">jumbo</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">Listener</span><span class="p">(</span><span class="n">jumbo_Database</span><span class="p">,</span>
                                <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;table_changed&#39;</span><span class="p">,</span>
                                <span class="n">handler</span><span class="o">=</span><span class="n">handler</span><span class="p">)</span>
<span class="c1"># Run threads</span>
<span class="n">dumbo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt id="jumbo.handlers.Listener.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; NoReturn<a class="reference internal" href="_modules/jumbo/handlers.html#Listener.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.Listener.run" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Spawns a greenthread subscribing to PostgreSQL database
notification channel and waits for NOTIFYs. On receipt the thread is
blocked and the Listener.handler() is fired. Once the handler has
finished processing the thread is finally unblocked and waits for
the next NOTIFY.</p>
</dd></dl>

<dl class="py method">
<dt id="jumbo.handlers.Listener.subscribe">
<code class="sig-name descname">subscribe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span><span class="p">:</span> <span class="n">eventlet.queue.Queue</span></em><span class="sig-paren">)</span> &#x2192; NoReturn<a class="reference internal" href="_modules/jumbo/handlers.html#Listener.subscribe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.Listener.subscribe" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Green thread process waiting for NOTIFYs on the channel and feeding
them to the queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>q</strong> â€“ event queue through which to pipe NOTIFY events to the main
thread.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="jumbo.handlers.NotifyHandler">
<em class="property">class </em><code class="sig-prename descclassname">jumbo.handlers.</code><code class="sig-name descname">NotifyHandler</code><a class="reference internal" href="_modules/jumbo/handlers.html#NotifyHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.NotifyHandler" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Abstract Handler managing actions performed on reception of a NOTIFY
from the database. Inherit from it to define your own custom handlers.</p>
<dl class="py method">
<dt id="jumbo.handlers.NotifyHandler.on_notify">
<code class="sig-name descname">on_notify</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#NotifyHandler.on_notify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.NotifyHandler.on_notify" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Procedure to execute once a NOTIFY is received.</p>
<p>Overwrite as needed</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="jumbo.handlers.mod_on_thread_start">
<code class="sig-prename descclassname">jumbo.handlers.</code><code class="sig-name descname">mod_on_thread_start</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span><span class="p">:</span> <span class="n">watchdog.observers.polling.PollingEmitter</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#mod_on_thread_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.mod_on_thread_start" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Override this method instead of <code class="xref py py-meth docutils literal notranslate"><span class="pre">start()</span></code>.
<code class="xref py py-meth docutils literal notranslate"><span class="pre">start()</span></code> actually calls this method.</p>
<p>This method is called right before this thread is started and this
objectâ€™s run() method is invoked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>self</strong> â€“ PollingEmitter object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="jumbo.handlers.mod_on_thread_stop">
<code class="sig-prename descclassname">jumbo.handlers.</code><code class="sig-name descname">mod_on_thread_stop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span><span class="p">:</span> <span class="n">watchdog.observers.polling.PollingEmitter</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/jumbo/handlers.html#mod_on_thread_stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.handlers.mod_on_thread_stop" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Override this method instead of <code class="xref py py-meth docutils literal notranslate"><span class="pre">stop()</span></code>.
<code class="xref py py-meth docutils literal notranslate"><span class="pre">stop()</span></code> actually calls this method.</p>
<p>This method is called immediately after the thread is signaled to stop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>self</strong> â€“ PollingEmitter object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-jumbo.utils">
<span id="jumbo-utils-module"></span><h2>jumbo.utils module<a class="headerlink" href="#module-jumbo.utils" title="Permalink to this headline">Â¶</a></h2>
<p>Utility functions for jumbo SQL library.</p>
<dl class="py function">
<dt id="jumbo.utils.convert_to_df">
<code class="sig-prename descclassname">jumbo.utils.</code><code class="sig-name descname">convert_to_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">results</span><span class="p">:</span> <span class="n">psycopg2.extras.DictRow</span></em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="_modules/jumbo/utils.html#convert_to_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#jumbo.utils.convert_to_df" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Converts SQL query results to a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>results</strong> â€“ results fetched from the PostgreSQL database following a
SQL query.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas DataFrame with query results.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-jumbo">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-jumbo" title="Permalink to this headline">Â¶</a></h2>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="modules.html" title="previous page">jumbo</a>
    <a class='right-next' id="next-link" href="tutorial_basic.html" title="next page">ðŸŽˆ Basic Usage</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Alvise Vianello<br/>
        
            &copy; Copyright 2020, Alvise Vianello.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>